<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 3 Base R (II) | RLads Lab</title>

    <meta name="author" content="Yongfu Liao" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.7.3/header-attrs.js"></script>
    <script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.2.4/tabs.js"></script>
    <script src="libs/bs3compat-0.2.4/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
    
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RLads Lab</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="lab03" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Base R (II)</h1>
<p><span class="course-resource">(<a href="https://docs.google.com/presentation/d/14naJhj_PYydPoyy9zvafk1TWQIbsqmIEsHeGgcYbkag">投影片</a> /
<a href="https://rlads2021.github.io/lab/src/04.zip">程式碼</a> /
<a href="#">影片</a>)
<!-- https://youtu.be/vuffe_EhTk0 --></span></p>
<div id="list" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> list</h2>
<ul>
<li><p>vector 是 R 裡面最「簡單」的資料結構。有時候我們需要比較更複雜的資料結構處理我們遇到的資料，例如，我們或許需要儲存<strong>不同資料類型</strong>或是<strong>具有階層結構</strong>的資料。面對這兩種需求，vector 無能為力，因此需要用到 R 的 list。</p></li>
<li><p>R 可以透過 <code>list()</code> 去製造出 list。<code>list()</code> 的使用方式很類似用來製造 vector 的 <code>c()</code>，但與 <code>c()</code> 不同的是，<code>list()</code></p>
<ol style="list-style-type: decimal">
<li><p>能使用<strong>不同的資料類型</strong></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="lab03.html#cb188-1" aria-hidden="true"></a><span class="kw">list</span>(<span class="ot">TRUE</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="st">&quot;Hello&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [1] TRUE
#&gt; 
#&gt; [[2]]
#&gt; [1] 1 2 3
#&gt; 
#&gt; [[3]]
#&gt; [1] &quot;Hello&quot;</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="lab03.html#cb190-1" aria-hidden="true"></a><span class="kw">list</span>(<span class="st">&#39;kai&#39;</span> =<span class="st"> </span><span class="ot">TRUE</span>, <span class="st">&#39;pooh&#39;</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="st">&#39;tiger&#39;</span> =<span class="st"> &quot;Hello&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; $kai
#&gt; [1] TRUE
#&gt; 
#&gt; $pooh
#&gt; [1] 1 2 3
#&gt; 
#&gt; $tiger
#&gt; [1] &quot;Hello&quot;</code></pre></li>
<li><p>具有階層結構，亦即，<code>list()</code> 裡面可以放入另一個 <code>list()</code></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="lab03.html#cb192-1" aria-hidden="true"></a><span class="kw">list</span>(<span class="fl">1.1</span>, <span class="kw">list</span>(<span class="fl">2.1</span>, <span class="st">&quot;Hello&quot;</span>))</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [1] 1.1
#&gt; 
#&gt; [[2]]
#&gt; [[2]][[1]]
#&gt; [1] 2.1
#&gt; 
#&gt; [[2]][[2]]
#&gt; [1] &quot;Hello&quot;</code></pre></li>
</ol></li>
</ul>
<div id="subsetting" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Subsetting</h3>
<ul>
<li><p>通常我們會習慣為 list 加上名字 (<code>names</code>)，幫助我們更容易處理這種比較複雜的資料結構</p></li>
<li><p><code>[]</code>: 與 vector 一樣，我們可以透過 <code>lst[&lt;char vector of names&gt;]</code>、<code>lst[&lt;integer vector&gt;]</code> 或 <code>lst[&lt;logical vector&gt;]</code> 去 subset list</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="lab03.html#cb194-1" aria-hidden="true"></a>pooh &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">age =</span> <span class="dv">20</span>, <span class="dt">single =</span> <span class="ot">FALSE</span>, <span class="dt">tags =</span> <span class="kw">c</span>(<span class="st">&quot;ig&quot;</span>, <span class="st">&quot;selfie&quot;</span>))</span>
<span id="cb194-2"><a href="lab03.html#cb194-2" aria-hidden="true"></a>pooh[<span class="st">&#39;single&#39;</span>]</span></code></pre></div>
<pre><code>#&gt; $single
#&gt; [1] FALSE</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="lab03.html#cb196-1" aria-hidden="true"></a>pooh[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>#&gt; $single
#&gt; [1] FALSE
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="lab03.html#cb198-1" aria-hidden="true"></a>pooh[<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;</code></pre></li>
<li><p>就像 <code>vec[&lt;some vector&gt;]</code> 會回傳<strong>一部分的 vector (sub-vector)</strong>；<code>lst[&lt;some vector&gt;]</code> 也會回傳<strong>一部分的 list (sub-list)</strong>。換言之，使用 <code>[]</code> 時，回傳值的<strong>資料結構不會改變</strong>。</p></li>
<li><p>我們可以將 list 想像成一列火車，每節車廂是一個長度為 1 的 sub-list，車廂<strong>裡面</strong>是這個 sub-list 儲存的值。欲取得 sub-list，使用的是 <code>[]</code>；欲取得 sub-list <strong>裡面的值</strong> (i.e. 脫去外層的 list)，需使用 <code>[[]]</code></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="lab03.html#cb200-1" aria-hidden="true"></a><span class="co"># 回傳 sub-list</span></span>
<span id="cb200-2"><a href="lab03.html#cb200-2" aria-hidden="true"></a><span class="kw">typeof</span>(pooh[<span class="st">&quot;tags&quot;</span>])</span>
<span id="cb200-3"><a href="lab03.html#cb200-3" aria-hidden="true"></a>pooh[<span class="st">&quot;tags&quot;</span>]</span>
<span id="cb200-4"><a href="lab03.html#cb200-4" aria-hidden="true"></a></span>
<span id="cb200-5"><a href="lab03.html#cb200-5" aria-hidden="true"></a><span class="co"># 回傳 list 之內的「值」，在此為一個 char vector</span></span>
<span id="cb200-6"><a href="lab03.html#cb200-6" aria-hidden="true"></a><span class="kw">typeof</span>(pooh[[<span class="st">&quot;tags&quot;</span>]])</span>
<span id="cb200-7"><a href="lab03.html#cb200-7" aria-hidden="true"></a>pooh[[<span class="st">&quot;tags&quot;</span>]]</span></code></pre></div>
<pre><code>#&gt; [1] &quot;list&quot;
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; 
#&gt; [1] &quot;character&quot;
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;</code></pre>
<ul>
<li><code>lst[["&lt;name&gt;"]]</code> 有另一種更簡便的寫法：<code>lst$&lt;name&gt;</code>, e.g. <code>pooh[["tags"]]</code> 可改寫成 <code>pooh$tags</code></li>
</ul></li>
</ul>
<div class="figure"><span id="fig:list-as-train"></span>
<img src="assets/img/list_as_train.png" alt="List as a train" width="100%" />
<p class="caption">
Figure 3.1: List as a train
</p>
</div>
</div>
<div id="nested-structure" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Nested Structure</h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="lab03.html#cb202-1" aria-hidden="true"></a>a_lst &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&quot;pooh&quot;</span>,</span>
<span id="cb202-2"><a href="lab03.html#cb202-2" aria-hidden="true"></a>              <span class="dt">info =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="dv">20</span>,</span>
<span id="cb202-3"><a href="lab03.html#cb202-3" aria-hidden="true"></a>                          <span class="dt">tags =</span> <span class="kw">c</span>(<span class="st">&quot;ig&quot;</span>, <span class="st">&quot;selfie&quot;</span>)))</span>
<span id="cb202-4"><a href="lab03.html#cb202-4" aria-hidden="true"></a></span>
<span id="cb202-5"><a href="lab03.html#cb202-5" aria-hidden="true"></a><span class="co"># Get &quot;selfie&quot;  </span></span>
<span id="cb202-6"><a href="lab03.html#cb202-6" aria-hidden="true"></a>a_lst[[<span class="st">&#39;info&#39;</span>]]</span>
<span id="cb202-7"><a href="lab03.html#cb202-7" aria-hidden="true"></a>a_lst[[<span class="st">&#39;info&#39;</span>]][[<span class="st">&#39;tags&#39;</span>]]</span>
<span id="cb202-8"><a href="lab03.html#cb202-8" aria-hidden="true"></a>a_lst[[<span class="st">&#39;info&#39;</span>]][[<span class="st">&#39;tags&#39;</span>]][<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; 
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; [1] &quot;selfie&quot;</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="lab03.html#cb204-1" aria-hidden="true"></a><span class="co"># Another way to get &quot;selfie&quot;</span></span>
<span id="cb204-2"><a href="lab03.html#cb204-2" aria-hidden="true"></a>a_lst[<span class="st">&#39;info&#39;</span>][[<span class="dv">1</span>]]</span>
<span id="cb204-3"><a href="lab03.html#cb204-3" aria-hidden="true"></a>a_lst[<span class="st">&#39;info&#39;</span>][[<span class="dv">1</span>]][<span class="st">&#39;tags&#39;</span>][[<span class="dv">1</span>]]</span>
<span id="cb204-4"><a href="lab03.html#cb204-4" aria-hidden="true"></a>a_lst[<span class="st">&#39;info&#39;</span>][[<span class="dv">1</span>]][<span class="st">&#39;tags&#39;</span>][[<span class="dv">1</span>]][<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; 
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; [1] &quot;selfie&quot;</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="lab03.html#cb206-1" aria-hidden="true"></a><span class="co"># Yet another way to get &quot;selfie&quot;</span></span>
<span id="cb206-2"><a href="lab03.html#cb206-2" aria-hidden="true"></a>a_lst[[<span class="dv">2</span>]]</span>
<span id="cb206-3"><a href="lab03.html#cb206-3" aria-hidden="true"></a>a_lst[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</span>
<span id="cb206-4"><a href="lab03.html#cb206-4" aria-hidden="true"></a>a_lst[[<span class="dv">2</span>]][[<span class="dv">2</span>]][<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; 
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; [1] &quot;selfie&quot;</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="lab03.html#cb208-1" aria-hidden="true"></a><span class="co"># The most &#39;readable&#39; way to get &quot;selfie&quot;</span></span>
<span id="cb208-2"><a href="lab03.html#cb208-2" aria-hidden="true"></a>a_lst<span class="op">$</span>info</span>
<span id="cb208-3"><a href="lab03.html#cb208-3" aria-hidden="true"></a>a_lst<span class="op">$</span>info<span class="op">$</span>tags</span>
<span id="cb208-4"><a href="lab03.html#cb208-4" aria-hidden="true"></a>a_lst<span class="op">$</span>info<span class="op">$</span>tags[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; 
#&gt; [1] &quot;ig&quot;     &quot;selfie&quot;
#&gt; [1] &quot;selfie&quot;</code></pre>
</div>
</div>
<div id="for-loop" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> for loop</h2>
<ul>
<li><p>上週介紹的條件式 (if-else) 讓我們可以依據不同狀況執行不同的程式碼，藉此能幫助我們寫出更有彈性的程式。迴圈讓我們能重複執行某一區塊的程式碼，如此就不需要重複寫出相同的程式碼。</p></li>
<li><p>R 有 for 與 while 迴圈。一般而言，在資料分析時非常少會用到 while 迴圈，因此實習課不作介紹，有興趣的同學可自行參考線上教材或教科書。</p></li>
<li><p>for loop 的結構如下</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="lab03.html#cb210-1" aria-hidden="true"></a><span class="cf">for</span> (<span class="op">&lt;</span>變數<span class="op">&gt;</span><span class="st"> </span><span class="cf">in</span> <span class="op">&lt;</span>vector<span class="op">&gt;</span>) {</span>
<span id="cb210-2"><a href="lab03.html#cb210-2" aria-hidden="true"></a>    <span class="op">&lt;</span>some code<span class="op">&gt;</span></span>
<span id="cb210-3"><a href="lab03.html#cb210-3" aria-hidden="true"></a>}</span></code></pre></div></li>
<li><p>for loop 會使 <code>{}</code> 內的程式碼重複執行數次，其次數等於 <code>&lt;vector&gt;</code> 的長度；並且，在第 n 次開始執行 <code>{}</code> 內的程式碼前，會將 <code>&lt;vector&gt;</code> 裡的第 n 個元素指派給 <code>&lt;變數&gt;</code>。所以在第一次迴圈時，可透過 <code>&lt;變數&gt;</code> 取得 <code>&lt;vector&gt;</code> 中的第一個元素；在第二次迴圈時，可取得 <code>&lt;vector&gt;</code> 中的第二個元素；依此類推，最後一次迴圈則可以透過 <code>&lt;變數&gt;</code> 取得 <code>&lt;vector&gt;</code> 中的最後一個元素。</p></li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="lab03.html#cb211-1" aria-hidden="true"></a>vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;謝&quot;</span>, <span class="st">&quot;老師&quot;</span>, <span class="st">&quot;好&quot;</span>, <span class="st">&quot;帥&quot;</span>)</span>
<span id="cb211-2"><a href="lab03.html#cb211-2" aria-hidden="true"></a>  </span>
<span id="cb211-3"><a href="lab03.html#cb211-3" aria-hidden="true"></a><span class="cf">for</span> (word <span class="cf">in</span> vec) {</span>
<span id="cb211-4"><a href="lab03.html#cb211-4" aria-hidden="true"></a>    <span class="co"># Will execute 4 times, </span></span>
<span id="cb211-5"><a href="lab03.html#cb211-5" aria-hidden="true"></a>    <span class="co"># each time a new value from `vec` will be assigned to `word`</span></span>
<span id="cb211-6"><a href="lab03.html#cb211-6" aria-hidden="true"></a>    <span class="kw">print</span>(word)</span>
<span id="cb211-7"><a href="lab03.html#cb211-7" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;謝&quot;
#&gt; [1] &quot;老師&quot;
#&gt; [1] &quot;好&quot;
#&gt; [1] &quot;帥&quot;</code></pre>
<div id="for-loop-的各種型態" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> for loop 的各種型態</h3>
<ul>
<li>R 的 for 只有一種結構：每次疊代將 vector (或 list) 中的一個元素指派給變數 (<code>&lt;var&gt; in &lt;vector&gt;</code>)。但因為 R 向量式程式語言的特性，R 的 for 迴圈很容易改寫成其它更方便的型態。</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>有時候我們需要知道<strong>迴圈進行到 <code>&lt;vector&gt;</code> 的第幾個元素</strong>，這時候通常會使用 <code>seq_along(&lt;vector&gt;)</code> 去製造出與 <code>&lt;vector&gt;</code> 等長的整數序列 (e.g. <code>seq_along(c('a', 'b', 'c'))</code> 會回傳 <code>1 2 3</code>)，如此我們便可知道進行到第幾次迴圈，也可透過 <code>&lt;vector&gt;[i]</code> 取得與該次迴圈對應的元素。</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="lab03.html#cb213-1" aria-hidden="true"></a>vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;謝&quot;</span>, <span class="st">&quot;老師&quot;</span>, <span class="st">&quot;好&quot;</span>, <span class="st">&quot;帥&quot;</span>)</span>
<span id="cb213-2"><a href="lab03.html#cb213-2" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(vec)) {</span>
<span id="cb213-3"><a href="lab03.html#cb213-3" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">paste</span>(i, vec[i]))</span>
<span id="cb213-4"><a href="lab03.html#cb213-4" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;1 謝&quot;
#&gt; [1] &quot;2 老師&quot;
#&gt; [1] &quot;3 好&quot;
#&gt; [1] &quot;4 帥&quot;</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="lab03.html#cb215-1" aria-hidden="true"></a>vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;謝&quot;</span>, <span class="st">&quot;老師&quot;</span>, <span class="st">&quot;好&quot;</span>, <span class="st">&quot;帥&quot;</span>)</span>
<span id="cb215-2"><a href="lab03.html#cb215-2" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(vec)) {</span>
<span id="cb215-3"><a href="lab03.html#cb215-3" aria-hidden="true"></a>    <span class="kw">print</span>(vec[i])</span>
<span id="cb215-4"><a href="lab03.html#cb215-4" aria-hidden="true"></a></span>
<span id="cb215-5"><a href="lab03.html#cb215-5" aria-hidden="true"></a>    <span class="co"># Print `?` in the last loop</span></span>
<span id="cb215-6"><a href="lab03.html#cb215-6" aria-hidden="true"></a>    <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(vec)) {</span>
<span id="cb215-7"><a href="lab03.html#cb215-7" aria-hidden="true"></a>        <span class="kw">print</span>(<span class="st">&#39;?&#39;</span>)</span>
<span id="cb215-8"><a href="lab03.html#cb215-8" aria-hidden="true"></a>    }</span>
<span id="cb215-9"><a href="lab03.html#cb215-9" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;謝&quot;
#&gt; [1] &quot;老師&quot;
#&gt; [1] &quot;好&quot;
#&gt; [1] &quot;帥&quot;
#&gt; [1] &quot;?&quot;</code></pre></li>
<li><p>我們也可以透過 <code>names()</code> 在 for loop 裡使用 <code>&lt;vector&gt;</code> 的 names 屬性：</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="lab03.html#cb217-1" aria-hidden="true"></a>vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Monday =</span> <span class="st">&quot;rainy&quot;</span>, <span class="dt">Tuesday =</span> <span class="st">&quot;cloudy&quot;</span>, <span class="dt">Wednesday =</span> <span class="st">&quot;sunny&quot;</span>)</span>
<span id="cb217-2"><a href="lab03.html#cb217-2" aria-hidden="true"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="kw">names</span>(vec)) {</span>
<span id="cb217-3"><a href="lab03.html#cb217-3" aria-hidden="true"></a>    <span class="kw">print</span>(<span class="kw">paste0</span>(name, <span class="st">&#39; was &#39;</span>, vec[name], <span class="st">&#39;.&#39;</span>))</span>
<span id="cb217-4"><a href="lab03.html#cb217-4" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;Monday was rainy.&quot;
#&gt; [1] &quot;Tuesday was cloudy.&quot;
#&gt; [1] &quot;Wednesday was sunny.&quot;</code></pre></li>
</ol>
<div class="hands-on" data-title="進階迴圈控制：break &amp; next">
<p>常常我們會需要對 for loop 有「更多的控制」。前面在 for loop 中使用到條件式即是一個例子。但常常條件式本身的功能並不足夠：執行迴圈時，在符合特定條件下，</p>
<ul>
<li><p>有時候我們會希望能<strong>忽略一次迴圈中「所有尚未被執行的程式碼」</strong>，這時就會使用到 <code>next</code>:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="lab03.html#cb219-1" aria-hidden="true"></a><span class="co"># 使用 next &#39;忽略一次&#39; 迴圈</span></span>
<span id="cb219-2"><a href="lab03.html#cb219-2" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb219-3"><a href="lab03.html#cb219-3" aria-hidden="true"></a>    <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {</span>
<span id="cb219-4"><a href="lab03.html#cb219-4" aria-hidden="true"></a>        <span class="kw">print</span>(<span class="st">&quot;Skipping print(i) if i == 5&quot;</span>)</span>
<span id="cb219-5"><a href="lab03.html#cb219-5" aria-hidden="true"></a>        <span class="cf">next</span></span>
<span id="cb219-6"><a href="lab03.html#cb219-6" aria-hidden="true"></a>    }</span>
<span id="cb219-7"><a href="lab03.html#cb219-7" aria-hidden="true"></a>    <span class="kw">print</span>(i)</span>
<span id="cb219-8"><a href="lab03.html#cb219-8" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] &quot;Skipping print(i) if i == 5&quot;
#&gt; [1] 6
#&gt; [1] 7
#&gt; [1] 8
#&gt; [1] 9
#&gt; [1] 10</code></pre></li>
<li><p>有時我們需要<strong>跳出整個迴圈</strong>，亦即不再執行 for loop 裡面的程式碼。這時就會使用到 <code>break</code>:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="lab03.html#cb221-1" aria-hidden="true"></a><span class="co"># 使用 break 跳出整個迴圈</span></span>
<span id="cb221-2"><a href="lab03.html#cb221-2" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb221-3"><a href="lab03.html#cb221-3" aria-hidden="true"></a>    <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {</span>
<span id="cb221-4"><a href="lab03.html#cb221-4" aria-hidden="true"></a>        <span class="kw">print</span>(<span class="st">&quot;Breaking out the for loop&quot;</span>)</span>
<span id="cb221-5"><a href="lab03.html#cb221-5" aria-hidden="true"></a>        <span class="cf">break</span></span>
<span id="cb221-6"><a href="lab03.html#cb221-6" aria-hidden="true"></a>    }</span>
<span id="cb221-7"><a href="lab03.html#cb221-7" aria-hidden="true"></a>    <span class="kw">print</span>(i)</span>
<span id="cb221-8"><a href="lab03.html#cb221-8" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] &quot;Breaking out the for loop&quot;</code></pre></li>
</ul>
<div id="實際應用修改檔案名稱" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> 實際應用：修改檔案名稱</h3>
<p>下方的程式碼能將多個檔案 (圖片) 重新命名 (並透過 <code>next</code> 忽略某些檔案)。有興趣者請下載<a href="https://rlads2019.github.io/lab/src/04.zip">原始碼</a>，裡面有一個資料夾 <code>dice/</code>。執行此程式碼前，需將<strong>工作目錄設至 <code>dice/</code> 資料夾</strong>。</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="lab03.html#cb223-1" aria-hidden="true"></a><span class="cf">for</span> (file <span class="cf">in</span> <span class="kw">list.files</span>()) {</span>
<span id="cb223-2"><a href="lab03.html#cb223-2" aria-hidden="true"></a>    <span class="co"># 忽略 `00_not_an_img.txt` 這個檔案</span></span>
<span id="cb223-3"><a href="lab03.html#cb223-3" aria-hidden="true"></a>    <span class="cf">if</span> (file <span class="op">==</span><span class="st"> &#39;00_not_an_img.txt&#39;</span>) {</span>
<span id="cb223-4"><a href="lab03.html#cb223-4" aria-hidden="true"></a>        <span class="cf">next</span></span>
<span id="cb223-5"><a href="lab03.html#cb223-5" aria-hidden="true"></a>    }</span>
<span id="cb223-6"><a href="lab03.html#cb223-6" aria-hidden="true"></a>    </span>
<span id="cb223-7"><a href="lab03.html#cb223-7" aria-hidden="true"></a>    <span class="kw">file.rename</span>(<span class="dt">from =</span> file, <span class="dt">to =</span> <span class="kw">paste0</span>(<span class="st">&#39;dice-&#39;</span>, file))</span>
<span id="cb223-8"><a href="lab03.html#cb223-8" aria-hidden="true"></a>}</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="wrap-upfor-loop-與-list" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Wrap up：for loop 與 list</h2>
<ul>
<li><p><a href="https://rlads2021.github.io/lab/notes/03.html#wrap-up">上週</a>我們使用過 3 個長度為 4 的 vector 來儲存關於 4 個人
(“kai”, “pooh”, “tiger”, “piglet”)
的資料。但使用這種方式儲存資料似乎有些違反直覺，因為它將關於一個人的資訊 (<code>name</code> 與 <code>age</code>) 分開來儲存在獨立的 vector。</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="lab03.html#cb224-1" aria-hidden="true"></a><span class="co"># Data</span></span>
<span id="cb224-2"><a href="lab03.html#cb224-2" aria-hidden="true"></a>name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;kai&quot;</span>, <span class="st">&quot;pooh&quot;</span>, <span class="st">&quot;tiger&quot;</span>, <span class="st">&quot;piglet&quot;</span>)</span>
<span id="cb224-3"><a href="lab03.html#cb224-3" aria-hidden="true"></a>age &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">19</span>)</span></code></pre></div></li>
<li><p>對於這種彼此之間具有關聯的資料，一種更好的方式是將它們<strong>儲存在一起</strong>，因為這不只幫助我們在「程式上」更容易去操弄這筆資料，更讓我們能以「階層組織」去「想像」我們的資料。這裡我們使用 <code>list</code> 去改寫上週的資料：</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="lab03.html#cb225-1" aria-hidden="true"></a>member &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb225-2"><a href="lab03.html#cb225-2" aria-hidden="true"></a>    <span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&quot;kai&quot;</span>, <span class="dt">age =</span> <span class="dv">40</span>),</span>
<span id="cb225-3"><a href="lab03.html#cb225-3" aria-hidden="true"></a>    <span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&quot;pooh&quot;</span>, <span class="dt">age =</span> <span class="dv">20</span>),</span>
<span id="cb225-4"><a href="lab03.html#cb225-4" aria-hidden="true"></a>    <span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&quot;tiger&quot;</span>, <span class="dt">age =</span> <span class="dv">18</span>),</span>
<span id="cb225-5"><a href="lab03.html#cb225-5" aria-hidden="true"></a>    <span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&quot;piglet&quot;</span>, <span class="dt">age =</span> <span class="dv">19</span>)</span>
<span id="cb225-6"><a href="lab03.html#cb225-6" aria-hidden="true"></a>)</span>
<span id="cb225-7"><a href="lab03.html#cb225-7" aria-hidden="true"></a></span>
<span id="cb225-8"><a href="lab03.html#cb225-8" aria-hidden="true"></a>member</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [[1]]$name
#&gt; [1] &quot;kai&quot;
#&gt; 
#&gt; [[1]]$age
#&gt; [1] 40
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$name
#&gt; [1] &quot;pooh&quot;
#&gt; 
#&gt; [[2]]$age
#&gt; [1] 20
#&gt; 
#&gt; 
#&gt; [[3]]
#&gt; [[3]]$name
#&gt; [1] &quot;tiger&quot;
#&gt; 
#&gt; [[3]]$age
#&gt; [1] 18
#&gt; 
#&gt; 
#&gt; [[4]]
#&gt; [[4]]$name
#&gt; [1] &quot;piglet&quot;
#&gt; 
#&gt; [[4]]$age
#&gt; [1] 19</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="lab03.html#cb227-1" aria-hidden="true"></a><span class="cf">for</span> (person <span class="cf">in</span> member) {</span>
<span id="cb227-2"><a href="lab03.html#cb227-2" aria-hidden="true"></a>    name &lt;-<span class="st"> </span>person<span class="op">$</span>name</span>
<span id="cb227-3"><a href="lab03.html#cb227-3" aria-hidden="true"></a>    age &lt;-<span class="st"> </span>person<span class="op">$</span>age</span>
<span id="cb227-4"><a href="lab03.html#cb227-4" aria-hidden="true"></a></span>
<span id="cb227-5"><a href="lab03.html#cb227-5" aria-hidden="true"></a>    <span class="co"># 將組成句子的片語儲存於 char vector `phrases`</span></span>
<span id="cb227-6"><a href="lab03.html#cb227-6" aria-hidden="true"></a>    phrases &lt;-<span class="st"> </span><span class="kw">c</span>(name, <span class="st">&quot; is &quot;</span>, age)</span>
<span id="cb227-7"><a href="lab03.html#cb227-7" aria-hidden="true"></a>    <span class="cf">if</span> (age <span class="op">&lt;</span><span class="st"> </span><span class="dv">35</span>) {</span>
<span id="cb227-8"><a href="lab03.html#cb227-8" aria-hidden="true"></a>        phrases[<span class="dv">4</span>] &lt;-<span class="st"> &quot;, which is quite young&quot;</span></span>
<span id="cb227-9"><a href="lab03.html#cb227-9" aria-hidden="true"></a>    }</span>
<span id="cb227-10"><a href="lab03.html#cb227-10" aria-hidden="true"></a></span>
<span id="cb227-11"><a href="lab03.html#cb227-11" aria-hidden="true"></a>    <span class="co"># 將各片語連接起來成為一個句子</span></span>
<span id="cb227-12"><a href="lab03.html#cb227-12" aria-hidden="true"></a>    sentence &lt;-<span class="st"> </span><span class="kw">paste0</span>(phrases,  <span class="dt">collapse =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb227-13"><a href="lab03.html#cb227-13" aria-hidden="true"></a></span>
<span id="cb227-14"><a href="lab03.html#cb227-14" aria-hidden="true"></a>    <span class="kw">print</span>(sentence)</span>
<span id="cb227-15"><a href="lab03.html#cb227-15" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;kai is 40&quot;
#&gt; [1] &quot;pooh is 20, which is quite young&quot;
#&gt; [1] &quot;tiger is 18, which is quite young&quot;
#&gt; [1] &quot;piglet is 19, which is quite young&quot;</code></pre></li>
</ul>
</div>
<div id="data-frame" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> data frame</h2>
<ul>
<li><p>data frame 是 R 語言非常重要的資料結構，它造就了 R 強大的<strong>表格式資料</strong>處理能力</p></li>
<li><p>data frame 是一種二維的資料結構。這種資料結構基本上與我們熟悉的 Excel (或 google 試算表) 非常類似：</p>
<div class="figure"><span id="fig:unnamed-chunk-57"></span>
<img src="https://img.yongfu.name/rlads/spreadsheet.png" alt="A data frame looks like an Excel Spreadsheet" width="80%" />
<p class="caption">
Figure 3.2: A data frame looks like an Excel Spreadsheet
</p>
</div>
<ul>
<li><p>data frame 的每一橫列 (row) 皆是一筆資料 (e.g. 一位受訪者所填的問卷)</p></li>
<li><p>data frame 的每一 (直) 欄 (column) 代表一個變項 (e.g. 問卷上的某個題目)</p></li>
</ul></li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-58"></span>
<img src="assets/img/tibble.png" alt="A Data Frame" width="80%" />
<p class="caption">
Figure 3.3: A Data Frame
</p>
</div>
<ul>
<li><p>我們可以使用 <code>tibble</code> 套件的 <code>tibble()</code><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> 建立 data frame。上圖中的 data frame 例子即可由下方的程式碼所建立:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="lab03.html#cb229-1" aria-hidden="true"></a><span class="kw">library</span>(tibble)</span>
<span id="cb229-2"><a href="lab03.html#cb229-2" aria-hidden="true"></a></span>
<span id="cb229-3"><a href="lab03.html#cb229-3" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">&quot;kai&quot;</span>, <span class="st">&quot;pooh&quot;</span>, <span class="st">&quot;tiger&quot;</span>, <span class="st">&quot;piglet&quot;</span>),</span>
<span id="cb229-4"><a href="lab03.html#cb229-4" aria-hidden="true"></a>             <span class="dt">age  =</span> <span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">19</span>), </span>
<span id="cb229-5"><a href="lab03.html#cb229-5" aria-hidden="true"></a>             <span class="dt">grad =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>))</span>
<span id="cb229-6"><a href="lab03.html#cb229-6" aria-hidden="true"></a>df</span></code></pre></div>
<pre><code>#&gt; # A tibble: 4 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai       40 FALSE
#&gt; 2 pooh      20 TRUE 
#&gt; 3 tiger     18 FALSE
#&gt; 4 piglet    19 TRUE</code></pre>
<ul>
<li><code>tibble()</code> 裡的每個 vector 對映到 data frame 中的一欄 (column)。因此 data frame 中不同欄的資料類型可能不同，但<strong>每一欄 (變項) 內的資料類型必須相同</strong> (因為 vector 只能儲存相同的資料類型)。</li>
</ul></li>
<li><p>下方的指令可用於檢視 data frame 的資訊</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="lab03.html#cb231-1" aria-hidden="true"></a><span class="kw">nrow</span>(df)   <span class="co"># number of rows</span></span>
<span id="cb231-2"><a href="lab03.html#cb231-2" aria-hidden="true"></a><span class="kw">ncol</span>(df)   <span class="co"># number of columns</span></span>
<span id="cb231-3"><a href="lab03.html#cb231-3" aria-hidden="true"></a><span class="kw">dim</span>(df)    <span class="co"># 形狀 (num of rows, num of columns)</span></span>
<span id="cb231-4"><a href="lab03.html#cb231-4" aria-hidden="true"></a><span class="kw">names</span>(df)  <span class="co"># name of each column</span></span></code></pre></div>
<pre><code>#&gt; [1] 4
#&gt; [1] 3
#&gt; [1] 4 3
#&gt; [1] &quot;name&quot; &quot;age&quot;  &quot;grad&quot;</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="lab03.html#cb233-1" aria-hidden="true"></a>tibble<span class="op">::</span><span class="kw">glimpse</span>(df)  <span class="co"># 關於 df 的各種資訊</span></span></code></pre></div>
<pre><code>#&gt; Rows: 4
#&gt; Columns: 3
#&gt; $ name &lt;chr&gt; &quot;kai&quot;, &quot;pooh&quot;, &quot;tiger&quot;, &quot;piglet&quot;
#&gt; $ age  &lt;dbl&gt; 40, 20, 18, 19
#&gt; $ grad &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="lab03.html#cb235-1" aria-hidden="true"></a><span class="kw">str</span>(df)              <span class="co"># 也可用 Base R 內建函數: str()</span></span></code></pre></div>
<pre><code>#&gt; tibble [4 × 3] (S3: tbl_df/tbl/data.frame)
#&gt;  $ name: chr [1:4] &quot;kai&quot; &quot;pooh&quot; &quot;tiger&quot; &quot;piglet&quot;
#&gt;  $ age : num [1:4] 40 20 18 19
#&gt;  $ grad: logi [1:4] FALSE TRUE FALSE TRUE</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="lab03.html#cb237-1" aria-hidden="true"></a><span class="kw">View</span>(df)   <span class="co"># View data frame in RStudio source pane</span></span></code></pre></div></li>
</ul>
<div id="subsetting-returning-a-data-frame" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Subsetting: returning a data frame</h3>
<ul>
<li><p>data frame 的篩選 (subsetting) 與 vector 和 list 類似，差別只在於 data frame 屬於二維的資料結構，因此需要提供 2 個 vector 進行資料的篩選：</p>
<pre class="null"><code>df[&lt;vector 1&gt;, &lt;vector 2&gt;]</code></pre>
<ul>
<li><p>在這裡，<code>&lt;vector 1&gt;</code> 篩選的是「列 (row)」，亦即，<code>&lt;vector 1&gt;</code> 決定要篩選出哪幾個觀察值 (observations)。<code>&lt;vector 2&gt;</code> 篩選的則是「欄 (column)」，亦即，<code>&lt;vector 2&gt;</code> 決定要篩選出哪些變項 (variables)。</p></li>
<li><p>以這種語法進行篩選，回傳的<strong>一定是 data frame</strong><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>，即使只有篩選出一個值 (e.g. df[1, 1])</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="lab03.html#cb239-1" aria-hidden="true"></a>df[<span class="dv">2</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 1
#&gt;   name 
#&gt;   &lt;chr&gt;
#&gt; 1 pooh</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="lab03.html#cb241-1" aria-hidden="true"></a>df[<span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]  <span class="co"># df[2, c(&quot;name&quot;, &quot;age&quot;)]</span></span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 2
#&gt;   name    age
#&gt;   &lt;chr&gt; &lt;dbl&gt;
#&gt; 1 pooh     20</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="lab03.html#cb243-1" aria-hidden="true"></a>df[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 pooh     20 TRUE</code></pre>
</div>
<div id="subsetting-returning-a-vector" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Subsetting: returning a vector</h3>
<ul>
<li><p>若想要從 data frame 裡面篩選出 vector (取得「火車車廂」<strong>內</strong>的值)，則要使用<a href="lab03.html#fig:list-as-train">之前提過</a>的 <code>$</code> 或 <code>[[]]</code>:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="lab03.html#cb245-1" aria-hidden="true"></a>df[[<span class="dv">2</span>]]      <span class="co"># df[[&lt;column_index&gt;]]</span></span>
<span id="cb245-2"><a href="lab03.html#cb245-2" aria-hidden="true"></a>df[[<span class="st">&quot;age&quot;</span>]]  <span class="co"># df[[&quot;&lt;column_name&gt;&quot;]]</span></span>
<span id="cb245-3"><a href="lab03.html#cb245-3" aria-hidden="true"></a>df<span class="op">$</span>age       <span class="co"># df$&lt;column_name&gt;, 最常見</span></span></code></pre></div>
<pre><code>#&gt; [1] 40 20 18 19
#&gt; [1] 40 20 18 19
#&gt; [1] 40 20 18 19</code></pre></li>
<li><p>篩選 data frame 而回傳 vector 是個很實用的技巧，因為我們可以使用這個回傳的 vector 當作我們進一步篩選 data frame 的依據，例如：</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="lab03.html#cb247-1" aria-hidden="true"></a>over19 &lt;-<span class="st"> </span>df<span class="op">$</span>age <span class="op">&gt;</span><span class="st"> </span><span class="dv">19</span>  </span>
<span id="cb247-2"><a href="lab03.html#cb247-2" aria-hidden="true"></a>over19</span></code></pre></div>
<pre><code>#&gt; [1]  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="lab03.html#cb249-1" aria-hidden="true"></a><span class="co"># subset df with obs. over 19</span></span>
<span id="cb249-2"><a href="lab03.html#cb249-2" aria-hidden="true"></a>df[over19, ]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai      40 FALSE
#&gt; 2 pooh     20 TRUE</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="lab03.html#cb251-1" aria-hidden="true"></a><span class="co"># subset df with obs. below or equal 19</span></span>
<span id="cb251-2"><a href="lab03.html#cb251-2" aria-hidden="true"></a>df[<span class="op">!</span>over19, ]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 tiger     18 FALSE
#&gt; 2 piglet    19 TRUE</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="lab03.html#cb253-1" aria-hidden="true"></a><span class="co"># 合併起來寫 (最常見的寫法，但比較難讀懂)</span></span>
<span id="cb253-2"><a href="lab03.html#cb253-2" aria-hidden="true"></a>df[df<span class="op">$</span>age <span class="op">&gt;</span><span class="st"> </span><span class="dv">19</span>, ]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai      40 FALSE
#&gt; 2 pooh     20 TRUE</code></pre></li>
<li><p>透過這個技巧，R 能幫助我們快速篩選出需要的資料，例如，我們可以結合 <code>age</code> 與 <code>grad</code> 兩個變項，篩選出「小於 20 歲且為研究所學生」的 data frame:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="lab03.html#cb255-1" aria-hidden="true"></a>df[(df<span class="op">$</span>age <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>grad), ]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 piglet    19 TRUE</code></pre></li>
</ul>

</div>
</div>
</div>


















<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>R 的內建函數 <code>data.frame()</code> 是最常被用於建立 data frame 的函數。<code>tibble</code> 套件裡的 <code>tibble()</code> 則與 <code>data.frame()</code> 的功能幾乎一樣，只是 <code>tibble()</code> 更改了 <code>data.frame()</code> 裡面常令使用者感到困惑的一些預設行為。<br><br />
<code>tibble</code> 套件為 <a href="https://www.tidyverse.org">Tidyverse</a> 套件群的一員，目的是為了解決 base R 眾多函數紛亂不一致的問題 (e.g. 命名不一致、預設行為不一致、類似的函數回傳值不一致等)。<a href="lab03.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>這只有使用 <code>tibble</code> 套件的 <code>tibble()</code> 所回傳的 data frame (class 為 <code>tbl_df</code>, <code>tbl</code> 與 <code>data.frame</code>) 才有這種特性。使用 R 的內建函數 <code>data.frame()</code> 所建立的 data frame 或是 R 的內建資料集 (class 只有 <code>data.frame</code>) 則會根據所篩選出之資料的形狀的不同而回傳不同的資料結構 (有可能是 <code>data.frame</code> 或是 <code>vector</code>)<a href="lab03.html#fnref12" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RLads Lab</strong>" was written by Yongfu Liao. It was last built on 2021-03-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
