<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Base R (II) | RLads Lab</title>
<meta name="author" content="Yongfu Liao">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RLads Lab</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">關於</a></li>
<li><a class="" href="ch01.html"><span class="header-section-number">1</span> 掌握你的電腦</a></li>
<li><a class="" href="ch02.html"><span class="header-section-number">2</span> Base R (I) &amp; 輔助工具</a></li>
<li><a class="active" href="ch03.html"><span class="header-section-number">3</span> Base R (II)</a></li>
<li><a class="" href="ch04.html"><span class="header-section-number">4</span> Data Transformation with dplyr</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rlads2021/LabBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ch03" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Base R (II)<a class="anchor" aria-label="anchor" href="#ch03"><i class="fas fa-link"></i></a>
</h1>
<p><span class="course-resource">(<a href="https://docs.google.com/presentation/d/14naJhj_PYydPoyy9zvafk1TWQIbsqmIEsHeGgcYbkag">投影片</a> /
<a href="https://rlads2021.github.io/lab/src/04.zip">程式碼</a> /
<a href="https://youtu.be/vuffe_EhTk0">影片</a>)</span></p>
<div id="list" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> list<a class="anchor" aria-label="anchor" href="#list"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>vector 是 R 裡面最「簡單」的資料結構。有時候我們需要比較更複雜的資料結構處理我們遇到的資料，例如，我們或許需要儲存<strong>不同資料類型</strong>或是<strong>具有階層結構</strong>的資料。面對這兩種需求，vector 無能為力，因此需要用到 R 的 list。</p></li>
<li>
<p>R 可以透過 <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> 去製造出 list。<code><a href="https://rdrr.io/r/base/list.html">list()</a></code> 的使用方式很類似用來製造 vector 的 <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>，但與 <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> 不同的是，<code><a href="https://rdrr.io/r/base/list.html">list()</a></code></p>
<ol style="list-style-type: decimal">
<li>
<p>能使用<strong>不同的資料類型</strong></p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"Hello"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [1] TRUE
#&gt; 
#&gt; [[2]]
#&gt; [1] 1 2 3
#&gt; 
#&gt; [[3]]
#&gt; [1] "Hello"</code></pre>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'kai'</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">'pooh'</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">'tiger'</span> <span class="op">=</span> <span class="st">"Hello"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; $kai
#&gt; [1] TRUE
#&gt; 
#&gt; $pooh
#&gt; [1] 1 2 3
#&gt; 
#&gt; $tiger
#&gt; [1] "Hello"</code></pre>
</li>
<li>
<p>具有階層結構，亦即，<code><a href="https://rdrr.io/r/base/list.html">list()</a></code> 裡面可以放入另一個 <code><a href="https://rdrr.io/r/base/list.html">list()</a></code></p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">2.1</span>, <span class="st">"Hello"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [1] 1.1
#&gt; 
#&gt; [[2]]
#&gt; [[2]][[1]]
#&gt; [1] 2.1
#&gt; 
#&gt; [[2]][[2]]
#&gt; [1] "Hello"</code></pre>
</li>
</ol>
</li>
</ul>
<div id="subsetting" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>通常我們會習慣為 list 加上名字 (<code>names</code>)，幫助我們更容易處理這種比較複雜的資料結構</p></li>
<li>
<p><code>[]</code>: 與 vector 一樣，我們可以透過 <code>lst[&lt;char vector of names&gt;]</code>、<code>lst[&lt;integer vector&gt;]</code> 或 <code>lst[&lt;logical vector&gt;]</code> 去 subset list</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pooh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">20</span>, single <span class="op">=</span> <span class="cn">FALSE</span>, tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ig"</span>, <span class="st">"selfie"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pooh</span><span class="op">[</span><span class="st">'single'</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $single
#&gt; [1] FALSE</code></pre>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pooh</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $single
#&gt; [1] FALSE
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pooh</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"</code></pre>
</li>
<li><p>就像 <code>vec[&lt;some vector&gt;]</code> 會回傳<strong>一部分的 vector (sub-vector)</strong>；<code>lst[&lt;some vector&gt;]</code> 也會回傳<strong>一部分的 list (sub-list)</strong>。換言之，使用 <code>[]</code> 時，回傳值的<strong>資料結構不會改變</strong>。</p></li>
<li>
<p>我們可以將 list 想像成一列火車，每節車廂是一個長度為 1 的 sub-list，車廂<strong>裡面</strong>是這個 sub-list 儲存的值。欲取得 sub-list，使用的是 <code>[]</code>；欲取得 sub-list <strong>裡面的值</strong> (i.e. 脫去外層的 list)，需使用 <code>[[]]</code></p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 回傳 sub-list</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">pooh</span><span class="op">[</span><span class="st">"tags"</span><span class="op">]</span><span class="op">)</span>
<span class="va">pooh</span><span class="op">[</span><span class="st">"tags"</span><span class="op">]</span>

<span class="co"># 回傳 list 之內的「值」，在此為一個 char vector</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">pooh</span><span class="op">[[</span><span class="st">"tags"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">pooh</span><span class="op">[[</span><span class="st">"tags"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; [1] "list"
#&gt; $tags
#&gt; [1] "ig"     "selfie"
#&gt; 
#&gt; [1] "character"
#&gt; [1] "ig"     "selfie"</code></pre>
<ul>
<li>
<code>lst[["&lt;name&gt;"]]</code> 有另一種更簡便的寫法：<code>lst$&lt;name&gt;</code>, e.g. <code>pooh[["tags"]]</code> 可改寫成 <code>pooh$tags</code>
</li>
</ul>
</li>
</ul>
<div class="figure" style="text-align: center">
<span id="fig:list-as-train"></span>
<img src="assets/img/list_as_train.png" alt="List as a train" width="100%"><p class="caption">
Figure 3.1: List as a train
</p>
</div>
</div>
<div id="nested-structure" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Nested Structure<a class="anchor" aria-label="anchor" href="#nested-structure"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"pooh"</span>,
              info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">20</span>,
                          tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ig"</span>, <span class="st">"selfie"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Get "selfie"  </span>
<span class="va">a_lst</span><span class="op">[[</span><span class="st">'info'</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[[</span><span class="st">'info'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'tags'</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[[</span><span class="st">'info'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'tags'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"
#&gt; 
#&gt; [1] "ig"     "selfie"
#&gt; [1] "selfie"</code></pre>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Another way to get "selfie"</span>
<span class="va">a_lst</span><span class="op">[</span><span class="st">'info'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[</span><span class="st">'info'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">'tags'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[</span><span class="st">'info'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">'tags'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"
#&gt; 
#&gt; [1] "ig"     "selfie"
#&gt; [1] "selfie"</code></pre>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Yet another way to get "selfie"</span>
<span class="va">a_lst</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="va">a_lst</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"
#&gt; 
#&gt; [1] "ig"     "selfie"
#&gt; [1] "selfie"</code></pre>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The most 'readable' way to get "selfie"</span>
<span class="va">a_lst</span><span class="op">$</span><span class="va">info</span>
<span class="va">a_lst</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">tags</span>
<span class="va">a_lst</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">tags</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; $age
#&gt; [1] 20
#&gt; 
#&gt; $tags
#&gt; [1] "ig"     "selfie"
#&gt; 
#&gt; [1] "ig"     "selfie"
#&gt; [1] "selfie"</code></pre>
</div>
</div>
<div id="for-loop" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> for loop<a class="anchor" aria-label="anchor" href="#for-loop"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>上週介紹的條件式 (if-else) 讓我們可以依據不同狀況執行不同的程式碼，藉此能幫助我們寫出更有彈性的程式。迴圈讓我們能重複執行某一區塊的程式碼，如此就不需要重複寫出相同的程式碼。</p></li>
<li><p>R 有 for 與 while 迴圈。一般而言，在資料分析時非常少會用到 while 迴圈，因此實習課不作介紹，有興趣的同學可自行參考線上教材或教科書。</p></li>
<li>
<p>for loop 的結構如下</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="ch03.html#cb210-1" aria-hidden="true"></a><span class="cf">for</span> (<span class="op">&lt;</span>變數<span class="op">&gt;</span><span class="st"> </span><span class="cf">in</span> <span class="op">&lt;</span>vector<span class="op">&gt;</span>) {</span>
<span id="cb210-2"><a href="ch03.html#cb210-2" aria-hidden="true"></a>    <span class="op">&lt;</span>some code<span class="op">&gt;</span></span>
<span id="cb210-3"><a href="ch03.html#cb210-3" aria-hidden="true"></a>}</span></code></pre></div>
</li>
<li><p>for loop 會使 <code>{}</code> 內的程式碼重複執行數次，其次數等於 <code>&lt;vector&gt;</code> 的長度；並且，在第 n 次開始執行 <code>{}</code> 內的程式碼前，會將 <code>&lt;vector&gt;</code> 裡的第 n 個元素指派給 <code>&lt;變數&gt;</code>。所以在第一次迴圈時，可透過 <code>&lt;變數&gt;</code> 取得 <code>&lt;vector&gt;</code> 中的第一個元素；在第二次迴圈時，可取得 <code>&lt;vector&gt;</code> 中的第二個元素；依此類推，最後一次迴圈則可以透過 <code>&lt;變數&gt;</code> 取得 <code>&lt;vector&gt;</code> 中的最後一個元素。</p></li>
</ul>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"謝"</span>, <span class="st">"老師"</span>, <span class="st">"好"</span>, <span class="st">"帥"</span><span class="op">)</span>
  
<span class="kw">for</span> <span class="op">(</span><span class="va">word</span> <span class="kw">in</span> <span class="va">vec</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Will execute 4 times, </span>
    <span class="co"># each time a new value from `vec` will be assigned to `word`</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">word</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] "謝"
#&gt; [1] "老師"
#&gt; [1] "好"
#&gt; [1] "帥"</code></pre>
<div id="for-loop-的各種型態" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> for loop 的各種型態<a class="anchor" aria-label="anchor" href="#for-loop-%E7%9A%84%E5%90%84%E7%A8%AE%E5%9E%8B%E6%85%8B"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>R 的 for 只有一種結構：每次疊代將 vector (或 list) 中的一個元素指派給變數 (<code>&lt;var&gt; in &lt;vector&gt;</code>)。但因為 R 向量式程式語言的特性，R 的 for 迴圈很容易改寫成其它更方便的型態。</li>
</ul>
<ol style="list-style-type: decimal">
<li>
<p>有時候我們需要知道<strong>迴圈進行到 <code>&lt;vector&gt;</code> 的第幾個元素</strong>，這時候通常會使用 <code>seq_along(&lt;vector&gt;)</code> 去製造出與 <code>&lt;vector&gt;</code> 等長的整數序列 (e.g. <code><a href="https://rdrr.io/r/base/seq.html">seq_along(c('a', 'b', 'c'))</a></code> 會回傳 <code>1 2 3</code>)，如此我們便可知道進行到第幾次迴圈，也可透過 <code>&lt;vector&gt;[i]</code> 取得與該次迴圈對應的元素。</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"謝"</span>, <span class="st">"老師"</span>, <span class="st">"好"</span>, <span class="st">"帥"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] "1 謝"
#&gt; [1] "2 老師"
#&gt; [1] "3 好"
#&gt; [1] "4 帥"</code></pre>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"謝"</span>, <span class="st">"老師"</span>, <span class="st">"好"</span>, <span class="st">"帥"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>

    <span class="co"># Print `?` in the last loop</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">'?'</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] "謝"
#&gt; [1] "老師"
#&gt; [1] "好"
#&gt; [1] "帥"
#&gt; [1] "?"</code></pre>
</li>
<li>
<p>我們也可以透過 <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> 在 for loop 裡使用 <code>&lt;vector&gt;</code> 的 names 屬性：</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Monday <span class="op">=</span> <span class="st">"rainy"</span>, Tuesday <span class="op">=</span> <span class="st">"cloudy"</span>, Wednesday <span class="op">=</span> <span class="st">"sunny"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">' was '</span>, <span class="va">vec</span><span class="op">[</span><span class="va">name</span><span class="op">]</span>, <span class="st">'.'</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] "Monday was rainy."
#&gt; [1] "Tuesday was cloudy."
#&gt; [1] "Wednesday was sunny."</code></pre>
</li>
</ol>
<div class="hands-on" data-title="進階迴圈控制：break &amp; next">
<p>常常我們會需要對 for loop 有「更多的控制」。前面在 for loop 中使用到條件式即是一個例子。但常常條件式本身的功能並不足夠：執行迴圈時，在符合特定條件下，</p>
<ul>
<li>
<p>有時候我們會希望能<strong>忽略一次迴圈中「所有尚未被執行的程式碼」</strong>，這時就會使用到 <code>next</code>:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 使用 next '忽略一次' 迴圈</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Skipping print(i) if i == 5"</span><span class="op">)</span>
        <span class="kw">next</span>
    <span class="op">}</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] "Skipping print(i) if i == 5"
#&gt; [1] 6
#&gt; [1] 7
#&gt; [1] 8
#&gt; [1] 9
#&gt; [1] 10</code></pre>
</li>
<li>
<p>有時我們需要<strong>跳出整個迴圈</strong>，亦即不再執行 for loop 裡面的程式碼。這時就會使用到 <code>break</code>:</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 使用 break 跳出整個迴圈</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Breaking out the for loop"</span><span class="op">)</span>
        <span class="kw">break</span>
    <span class="op">}</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] "Breaking out the for loop"</code></pre>
</li>
</ul>
<div id="實際應用修改檔案名稱" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> 實際應用：修改檔案名稱<a class="anchor" aria-label="anchor" href="#%E5%AF%A6%E9%9A%9B%E6%87%89%E7%94%A8%E4%BF%AE%E6%94%B9%E6%AA%94%E6%A1%88%E5%90%8D%E7%A8%B1"><i class="fas fa-link"></i></a>
</h3>
<p>下方的程式碼能將多個檔案 (圖片) 重新命名 (並透過 <code>next</code> 忽略某些檔案)。有興趣者請下載<a href="https://rlads2019.github.io/lab/src/04.zip">原始碼</a>，裡面有一個資料夾 <code>dice/</code>。執行此程式碼前，需將<strong>工作目錄設至 <code>dice/</code> 資料夾</strong>。</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">file</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># 忽略 `00_not_an_img.txt` 這個檔案</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">file</span> <span class="op">==</span> <span class="st">'00_not_an_img.txt'</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">next</span>
    <span class="op">}</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.rename</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">file</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'dice-'</span>, <span class="va">file</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="wrap-upfor-loop-與-list" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Wrap up：for loop 與 list<a class="anchor" aria-label="anchor" href="#wrap-upfor-loop-%E8%88%87-list"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p><a href="https://rlads2021.github.io/lab/notes/03.html#wrap-up">上週</a>我們使用過 3 個長度為 4 的 vector 來儲存關於 4 個人
(“kai”, “pooh”, “tiger”, “piglet”)
的資料。但使用這種方式儲存資料似乎有些違反直覺，因為它將關於一個人的資訊 (<code>name</code> 與 <code>age</code>) 分開來儲存在獨立的 vector。</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data</span>
<span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kai"</span>, <span class="st">"pooh"</span>, <span class="st">"tiger"</span>, <span class="st">"piglet"</span><span class="op">)</span>
<span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span></code></pre></div>
</li>
<li>
<p>對於這種彼此之間具有關聯的資料，一種更好的方式是將它們<strong>儲存在一起</strong>，因為這不只幫助我們在「程式上」更容易去操弄這筆資料，更讓我們能以「階層組織」去「想像」我們的資料。這裡我們使用 <code>list</code> 去改寫上週的資料：</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">member</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"kai"</span>, age <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"pooh"</span>, age <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"tiger"</span>, age <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"piglet"</span>, age <span class="op">=</span> <span class="fl">19</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">member</span></code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [[1]]$name
#&gt; [1] "kai"
#&gt; 
#&gt; [[1]]$age
#&gt; [1] 40
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$name
#&gt; [1] "pooh"
#&gt; 
#&gt; [[2]]$age
#&gt; [1] 20
#&gt; 
#&gt; 
#&gt; [[3]]
#&gt; [[3]]$name
#&gt; [1] "tiger"
#&gt; 
#&gt; [[3]]$age
#&gt; [1] 18
#&gt; 
#&gt; 
#&gt; [[4]]
#&gt; [[4]]$name
#&gt; [1] "piglet"
#&gt; 
#&gt; [[4]]$age
#&gt; [1] 19</code></pre>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">person</span> <span class="kw">in</span> <span class="va">member</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">name</span> <span class="op">&lt;-</span> <span class="va">person</span><span class="op">$</span><span class="va">name</span>
    <span class="va">age</span> <span class="op">&lt;-</span> <span class="va">person</span><span class="op">$</span><span class="va">age</span>

    <span class="co"># 將組成句子的片語儲存於 char vector `phrases`</span>
    <span class="va">phrases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">" is "</span>, <span class="va">age</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">35</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">phrases</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">", which is quite young"</span>
    <span class="op">}</span>

    <span class="co"># 將各片語連接起來成為一個句子</span>
    <span class="va">sentence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">phrases</span>,  collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sentence</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>#&gt; [1] "kai is 40"
#&gt; [1] "pooh is 20, which is quite young"
#&gt; [1] "tiger is 18, which is quite young"
#&gt; [1] "piglet is 19, which is quite young"</code></pre>
</li>
</ul>
</div>
<div id="data-frame" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> data frame<a class="anchor" aria-label="anchor" href="#data-frame"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>data frame 是 R 語言非常重要的資料結構，它造就了 R 強大的<strong>表格式資料</strong>處理能力</p></li>
<li>
<p>data frame 是一種二維的資料結構。這種資料結構基本上與我們熟悉的 Excel (或 google 試算表) 非常類似：</p>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-57"></span>
<img src="https://img.yongfu.name/rlads/spreadsheet.png" alt="A data frame looks like an Excel Spreadsheet" width="70%"><p class="caption">
Figure 3.2: A data frame looks like an Excel Spreadsheet
</p>
</div>
<ul>
<li><p>data frame 的每一橫列 (row) 皆是一筆資料 (e.g. 一位受訪者所填的問卷)</p></li>
<li><p>data frame 的每一 (直) 欄 (column) 代表一個變項 (e.g. 問卷上的某個題目)</p></li>
</ul>
</li>
</ul>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-58"></span>
<img src="assets/img/tibble.png" alt="A Data Frame" width="70%"><p class="caption">
Figure 3.3: A Data Frame
</p>
</div>
<ul>
<li>
<p>我們可以使用 <code>tibble</code> 套件的 <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;R 的內建函數 &lt;code&gt;data.frame()&lt;/code&gt; 是最常被用於建立 data frame 的函數。&lt;code&gt;tibble&lt;/code&gt; 套件裡的 &lt;code&gt;tibble()&lt;/code&gt; 則與 &lt;code&gt;data.frame()&lt;/code&gt; 的功能幾乎一樣，只是 &lt;code&gt;tibble()&lt;/code&gt; 更改了 &lt;code&gt;data.frame()&lt;/code&gt; 裡面常令使用者感到困惑的一些預設行為。&lt;br&gt;&lt;br&gt;&lt;code&gt;tibble&lt;/code&gt; 套件為 &lt;a href="https://www.tidyverse.org"&gt;Tidyverse&lt;/a&gt; 套件群的一員，目的是為了解決 base R 眾多函數紛亂不一致的問題 (e.g. 命名不一致、預設行為不一致、類似的函數回傳值不一致等)。&lt;/p&gt;'><sup>11</sup></a> 建立 data frame。上圖中的 data frame 例子即可由下方的程式碼所建立:</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kai"</span>, <span class="st">"pooh"</span>, <span class="st">"tiger"</span>, <span class="st">"piglet"</span><span class="op">)</span>,
             age  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">19</span><span class="op">)</span>, 
             grad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span></code></pre></div>
<pre><code>#&gt; # A tibble: 4 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai       40 FALSE
#&gt; 2 pooh      20 TRUE 
#&gt; 3 tiger     18 FALSE
#&gt; 4 piglet    19 TRUE</code></pre>
<ul>
<li>
<code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code> 裡的每個 vector 對映到 data frame 中的一欄 (column)。因此 data frame 中不同欄的資料類型可能不同，但<strong>每一欄 (變項) 內的資料類型必須相同</strong> (因為 vector 只能儲存相同的資料類型)。</li>
</ul>
</li>
<li>
<p>下方的指令可用於檢視 data frame 的資訊</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>   <span class="co"># number of rows</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>   <span class="co"># number of columns</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>    <span class="co"># 形狀 (num of rows, num of columns)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>  <span class="co"># name of each column</span></code></pre></div>
<pre><code>#&gt; [1] 4
#&gt; [1] 3
#&gt; [1] 4 3
#&gt; [1] "name" "age"  "grad"</code></pre>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>  <span class="co"># 關於 df 的各種資訊</span></code></pre></div>
<pre><code>#&gt; Rows: 4
#&gt; Columns: 3
#&gt; $ name &lt;chr&gt; "kai", "pooh", "tiger", "piglet"
#&gt; $ age  &lt;dbl&gt; 40, 20, 18, 19
#&gt; $ grad &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>              <span class="co"># 也可用 Base R 內建函數: str()</span></code></pre></div>
<pre><code>#&gt; tibble [4 × 3] (S3: tbl_df/tbl/data.frame)
#&gt;  $ name: chr [1:4] "kai" "pooh" "tiger" "piglet"
#&gt;  $ age : num [1:4] 40 20 18 19
#&gt;  $ grad: logi [1:4] FALSE TRUE FALSE TRUE</code></pre>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>   <span class="co"># View data frame in RStudio source pane</span></code></pre></div>
</li>
</ul>
<div id="subsetting-returning-a-data-frame" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Subsetting: returning a data frame<a class="anchor" aria-label="anchor" href="#subsetting-returning-a-data-frame"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>data frame 的篩選 (subsetting) 與 vector 和 list 類似，差別只在於 data frame 屬於二維的資料結構，因此需要提供 2 個 vector 進行資料的篩選：</p>
<pre class="null"><code>df[&lt;vector 1&gt;, &lt;vector 2&gt;]</code></pre>
<ul>
<li><p>在這裡，<code>&lt;vector 1&gt;</code> 篩選的是「列 (row)」，亦即，<code>&lt;vector 1&gt;</code> 決定要篩選出哪幾個觀察值 (observations)。<code>&lt;vector 2&gt;</code> 篩選的則是「欄 (column)」，亦即，<code>&lt;vector 2&gt;</code> 決定要篩選出哪些變項 (variables)。</p></li>
<li><p>以這種語法進行篩選，回傳的<strong>一定是 data frame</strong><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;這只有使用 &lt;code&gt;tibble&lt;/code&gt; 套件的 &lt;code&gt;tibble()&lt;/code&gt; 所回傳的 data frame (class 為 &lt;code&gt;tbl_df&lt;/code&gt;, &lt;code&gt;tbl&lt;/code&gt; 與 &lt;code&gt;data.frame&lt;/code&gt;) 才有這種特性。使用 R 的內建函數 &lt;code&gt;data.frame()&lt;/code&gt; 所建立的 data frame 或是 R 的內建資料集 (class 只有 &lt;code&gt;data.frame&lt;/code&gt;) 則會根據所篩選出之資料的形狀的不同而回傳不同的資料結構 (有可能是 &lt;code&gt;data.frame&lt;/code&gt; 或是 &lt;code&gt;vector&lt;/code&gt;)&lt;/p&gt;"><sup>12</sup></a>，即使只有篩選出一個值 (e.g. df[1, 1])</p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 1
#&gt;   name 
#&gt;   &lt;chr&gt;
#&gt; 1 pooh</code></pre>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># df[2, c("name", "age")]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 2
#&gt;   name    age
#&gt;   &lt;chr&gt; &lt;dbl&gt;
#&gt; 1 pooh     20</code></pre>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 pooh     20 TRUE</code></pre>
</div>
<div id="subsetting-returning-a-vector" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Subsetting: returning a vector<a class="anchor" aria-label="anchor" href="#subsetting-returning-a-vector"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>若想要從 data frame 裡面篩選出 vector (取得「火車車廂」<strong>內</strong>的值)，則要使用<a href="ch03.html#fig:list-as-train">之前提過</a>的 <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> 或 <code>[[]]</code>:</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>      <span class="co"># df[[&lt;column_index&gt;]]</span>
<span class="va">df</span><span class="op">[[</span><span class="st">"age"</span><span class="op">]</span><span class="op">]</span>  <span class="co"># df[["&lt;column_name&gt;"]]</span>
<span class="va">df</span><span class="op">$</span><span class="va">age</span>       <span class="co"># df$&lt;column_name&gt;, 最常見</span></code></pre></div>
<pre><code>#&gt; [1] 40 20 18 19
#&gt; [1] 40 20 18 19
#&gt; [1] 40 20 18 19</code></pre>
</li>
<li>
<p>篩選 data frame 而回傳 vector 是個很實用的技巧，因為我們可以使用這個回傳的 vector 當作我們進一步篩選 data frame 的依據，例如：</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">over19</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">19</span>  
<span class="va">over19</span></code></pre></div>
<pre><code>#&gt; [1]  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset df with obs. over 19</span>
<span class="va">df</span><span class="op">[</span><span class="va">over19</span>, <span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai      40 FALSE
#&gt; 2 pooh     20 TRUE</code></pre>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subset df with obs. below or equal 19</span>
<span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="va">over19</span>, <span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 tiger     18 FALSE
#&gt; 2 piglet    19 TRUE</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 合併起來寫 (最常見的寫法，但比較難讀懂)</span>
<span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">19</span>, <span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 x 3
#&gt;   name    age grad 
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 kai      40 FALSE
#&gt; 2 pooh     20 TRUE</code></pre>
</li>
<li>
<p>透過這個技巧，R 能幫助我們快速篩選出需要的資料，例如，我們可以結合 <code>age</code> 與 <code>grad</code> 兩個變項，篩選出「小於 20 歲且為研究所學生」的 data frame:</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">grad</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 x 3
#&gt;   name     age grad 
#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 piglet    19 TRUE</code></pre>
</li>
</ul>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="ch02.html"><span class="header-section-number">2</span> Base R (I) &amp; 輔助工具</a></div>
<div class="next"><a href="ch04.html"><span class="header-section-number">4</span> Data Transformation with dplyr</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ch03"><span class="header-section-number">3</span> Base R (II)</a></li>
<li>
<a class="nav-link" href="#list"><span class="header-section-number">3.1</span> list</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsetting"><span class="header-section-number">3.1.1</span> Subsetting</a></li>
<li><a class="nav-link" href="#nested-structure"><span class="header-section-number">3.1.2</span> Nested Structure</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#for-loop"><span class="header-section-number">3.2</span> for loop</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#for-loop-%E7%9A%84%E5%90%84%E7%A8%AE%E5%9E%8B%E6%85%8B"><span class="header-section-number">3.2.1</span> for loop 的各種型態</a></li>
<li><a class="nav-link" href="#%E5%AF%A6%E9%9A%9B%E6%87%89%E7%94%A8%E4%BF%AE%E6%94%B9%E6%AA%94%E6%A1%88%E5%90%8D%E7%A8%B1"><span class="header-section-number">3.2.2</span> 實際應用：修改檔案名稱</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-upfor-loop-%E8%88%87-list"><span class="header-section-number">3.3</span> Wrap up：for loop 與 list</a></li>
<li>
<a class="nav-link" href="#data-frame"><span class="header-section-number">3.4</span> data frame</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#subsetting-returning-a-data-frame"><span class="header-section-number">3.4.1</span> Subsetting: returning a data frame</a></li>
<li><a class="nav-link" href="#subsetting-returning-a-vector"><span class="header-section-number">3.4.2</span> Subsetting: returning a vector</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rlads2021/LabBook/blob/master/03-list_loop_dataframe.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rlads2021/LabBook/edit/master/03-list_loop_dataframe.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RLads Lab</strong>" was written by Yongfu Liao. It was last built on <span class="date">March 21, 2021</span>.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
